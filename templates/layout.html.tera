<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% set brand_name = "Kinetic" %}
    {% set brand_logo = "/static/logo.png" %}
    {% set brand_primary = "#f59e0b" %}
    {% set brand_secondary = "#ef4444" %}
    {% set brand_on_primary = "#111827" %}
    {% set brand_hue = 32 %}
    {% set brand_body_font = "Space Grotesk" %}
    {% set brand_heading_font = "Space Grotesk" %}
    {% if workspace_brand is defined %}
      {% set brand_name = workspace_brand.app_name %}
      {% set brand_logo = workspace_brand.logo_url %}
      {% set brand_primary = workspace_brand.primary %}
      {% set brand_secondary = workspace_brand.secondary %}
      {% set brand_on_primary = workspace_brand.on_primary %}
      {% set brand_hue = workspace_brand.background_hue %}
      {% set brand_body_font = workspace_brand.body_font %}
      {% set brand_heading_font = workspace_brand.heading_font %}
    {% endif %}
    <title>{{ title }} | {{ brand_name }}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Sora:wght@400;500;600;700&family=DM+Sans:wght@400;500;600;700&family=IBM+Plex+Sans:wght@400;500;600;700&family=Work+Sans:wght@400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    {% if include_map %}
      <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet">
      <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    {% endif %}
    <link href="/static/styles.css" rel="stylesheet">
    <style>
      :root {
        --kinetic-primary: {{ brand_primary }};
        --kinetic-primary-dark: {{ brand_secondary }};
        --kinetic-on-primary: {{ brand_on_primary }};
        --kinetic-chart-start: {{ brand_primary }};
        --kinetic-chart-end: {{ brand_secondary }};
        --kinetic-chart-stroke: {{ brand_primary }};
        --kinetic-chart-point: {{ brand_secondary }};
        --kinetic-chart-soft: color-mix(in srgb, {{ brand_primary }} 18%, transparent);
        --kinetic-chart-soft-1: color-mix(in srgb, {{ brand_primary }} 12%, transparent);
        --kinetic-chart-soft-2: color-mix(in srgb, {{ brand_secondary }} 12%, transparent);
        --kinetic-chart-border: color-mix(in srgb, {{ brand_secondary }} 30%, transparent);
        --kinetic-chart-line-1: color-mix(in srgb, {{ brand_primary }} 50%, transparent);
        --kinetic-chart-line-2: color-mix(in srgb, {{ brand_secondary }} 50%, transparent);
        --kinetic-chart-donut-base: color-mix(in srgb, {{ brand_primary }} 30%, transparent);
        --kinetic-chart-donut-accent: color-mix(in srgb, {{ brand_secondary }} 50%, transparent);
        --kinetic-bg-hue: {{ brand_hue }};
        --kinetic-font-body: '{{ brand_body_font }}';
        --kinetic-font-heading: '{{ brand_heading_font }}';
      }
    </style>
  </head>
  <body class="app-shell">
    <div class="page-glow"></div>
    <nav class="navbar navbar-expand-lg py-3">
      <div class="container">
        {% if is_portal %}
          <div class="navbar-brand d-flex align-items-center">
            <img src="{{ brand_logo }}" alt="{{ brand_name }} logo" class="brand-logo">
            <span class="brand-title">{{ brand_name }}</span>
          </div>
        {% else %}
          <a class="navbar-brand d-flex align-items-center" href="/">
            <img src="{{ brand_logo }}" alt="{{ brand_name }} logo" class="brand-logo">
            <span class="brand-title">{{ brand_name }}</span>
          </a>
        {% endif %}
        {% if (current_user or admin_email is defined) and not is_portal %}
          <div class="ops-live">
            <span class="ops-live-dot"></span>
            Live ops
          </div>
        {% endif %}
        {% if not is_portal %}
          <div class="d-flex align-items-center gap-2 navbar-actions">
            {% if current_user %}
              <span class="text-muted small">Workspace: {{ current_user.tenant_slug }}</span>
              <a class="btn btn-outline-light btn-sm" href="/{{ current_user.tenant_slug }}/dashboard">Dashboard</a>
              {% if current_user.plan_key != "enterprise" %}
                <a class="btn btn-primary btn-sm" href="/{{ current_user.tenant_slug }}/plans">Upgrade</a>
              {% endif %}
              <a class="btn btn-outline-light btn-sm" href="/logout">Log out</a>
            {% elif admin_email is defined %}
              <span class="text-muted small">Workspace: admin</span>
              <a class="btn btn-outline-light btn-sm" href="/admin/dashboard">Dashboard</a>
              <a class="btn btn-outline-light btn-sm" href="/admin/logout">Log out</a>
            {% else %}
              <a class="btn btn-outline-light btn-sm" href="/login">Log in</a>
              <a class="btn btn-primary btn-sm" href="/register">Create workspace</a>
            {% endif %}
          </div>
        {% endif %}
      </div>
    </nav>
    {% if current_user and current_user.plan_expired %}
      <div class="container">
        <div class="alert alert-warning d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between gap-3">
          <div>
            <strong>Plan expired.</strong> Upgrade to resume changes. You can still view your data.
          </div>
          <a class="btn btn-sm btn-primary" href="/{{ current_user.tenant_slug }}/plans">Upgrade now</a>
        </div>
      </div>
    {% endif %}
    <main class="container py-5">
      {% block content %}{% endblock content %}
    </main>
    <footer class="app-footer">
      <div class="container">
        Powered by Kinetic 2026 Â· v0.1.0
      </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
